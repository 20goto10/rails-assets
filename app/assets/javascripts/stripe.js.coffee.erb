DEFAUT_AMOUNT = 5

DonationController = ($scope, $http) ->
  handler = StripeCheckout.configure
    key: '<%= Rails.configuration.stripe[:publishable_key] %>'
    locale: 'auto'
    token: (token) ->
      $http.post(Routes.donations_path(), { amount: $scope.amount, token: token })

  $scope.amount = DEFAUT_AMOUNT

  $scope.invoke = ->
    handler.open
      name: 'Rails Assets'
      description: 'Donation'
      amount: $scope.amount * 100

angular.module('rails-assets').controller 'DonationCtrl', [
  '$scope',
  '$http',
  DonationController
]
